

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.0-rc.6/css/uikit.min.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.0-rc.6/js/uikit.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.0-rc.6/js/uikit-icons.min.js"></script>
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/railscasts.min.css"/>
    <script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/java.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
  <style>
    

body {
  font-family: "Open Sans", "Helvetica", "Helvetica Neue",  "Arial", sans-serif;
  font-size:90%;
  color: black;
}

p {
  margin: 0.5em;
}

pre code {
  font-family: "Monaco";
  font-size: 100%;
}

img {
  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
  margin:10px;
}

h1, h2, h3 {
  border-bottom:thin solid black;
  margin-bottom: 0.5em;
  margin-top: 1em;
}

h1 {
  font-style:italic;
  font-size:130%;
}

h2 {
  font-size:110%;
}

h3 {
  font-size:100%;
}



  </style>

  <body class="lab">

    
  <div class="uk-offcanvas-content">
    <div id="offcanvas-usage" uk-offcanvas>
      <div class="uk-offcanvas-bar">
        <button class="uk-offcanvas-close" type="button" uk-close></button>
        <ul class="uk-nav">
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic01/book-a-donation-01/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
Donation-01
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic02-a/book-a-donation-02/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
Donation-02
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic02-b/book-b-donation-03/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
Donation-03
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic03-a/book-a-solutions-donation-03/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
Donation-03-Solutions
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic03-a/book-b-myrent-00-Baseline/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
MyRent-00 (Baseline)
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic03-a/book-c-myrent-01-Widgets/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
MyRent-01 (Widgets)
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic03-b/book-a-myrent-02-Listview/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
MyRent-02 (Listview)
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic03-b/book-b-event-handling/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
Event-Handling
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic04-a/book-a-myrent-03-Action-Bar-Dialogs/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
MyRent-03 (Action Bar & Dialogs)
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic04-a/book-b-myrent-04-fileIO/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
MyRent-04 (FileIO)
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic04-b/book-a-myrent-05-Up-Button/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
MyRent-05 (Up Button)
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic04-b/book-b-java-8/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
Lambda Expressions
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic04-b/book-c-event-handler-soln/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
Event-Handling-Solution
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic05-a/book-a-myrent-06-Contact-Email/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
MyRent-06 (Contact & Email)
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic05-a/book-b-permissions/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
MyRent-06a (Permissions)
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic05-b/book-a-myrent-07-Fragments/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
MyRent-07 (Fragments)
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic05-b/book-b-twopane/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
Two Pane
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic06-a/book-a-myrent-08-Deletion/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
MyRent-08 (Deletion)
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic06-a/book-b-myrent-09-Viewpager/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
MyRent-09 (ViewPager)
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic06-b/book-a-settings/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
MyRent-10 (Settings)
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic07-a/book-a-myrent-10-Maps-Google/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
MyRent-11 (Maps - Google)
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic07-a/book-b-myrent-10-Maps-MapBox/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
MyRent-11a (Maps - MapBox)
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic07-b/book-a-myrent-sqlite-SQLite/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
MyRentSQLite (SQLite)
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic08-a/book-a-myrent-12-SQLite/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
MyRent-12 (SQLite)
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic08-b/book-b-myrent-sqlite-ContentProvider/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
MyRentSQLite (ContentProvider)
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic09-a/book-a-myrent-service/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
MyRent (Play Service)
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic09-a/book-a-myrent-service-test/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
MyRent (JUnit Test)
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic09-a/book-b-myrent-14-Retrofit-Client/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
MyRent-13 (Client)
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic10-a/book-b-services/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
MyRent-14 (Services)
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic11-a/book-a-myrent-11-Camera/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
MyRent-15 (Camera)
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic11-b/book-a-crypto/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
App Signing & Crypto
                </a>
              </li>
            
          
            
              <li>
                <a class="item" href="https://edeleastar-portfolio.github.io/android-app-dev//topic11-c/book-a-myrent-16-Mongo/index.html">
  <i class="fas fa-flask " style="color:#00BCD4"> </i>
MyRent-16 (Mongo)
                </a>
              </li>
            
          
        </ul>
      </div>
    </div>
  </div>


    <div uk-sticky>
      <nav class="uk-navbar">
        <div class="uk-navbar-left">
          <ul class="uk-subnav uk-background-secondary uk-subnav-pill">
            <li><a href="#offcanvas-usage" uk-icon="icon: menu" , uk-toggle title="Switch Lab" pos="bottom"
                   uk-tooltip></a></li>
            <li class="uk-active"><a href="../index.html" uk-icon="icon: chevron-up" uk-toggle title="Parent Topic"
                                     pos="bottom" uk-tooltip>4-a: Navigation & Lifecycles </a></li>
          </ul>
        </div>
        <div class="uk-navbar-right">
          <ul class="uk-subnav uk-background-secondary uk-subnav-pill"
              uk-switcher="connect: .switcher-container">
            
              <li><a href="#">MyRent-03 (Action Bar & Dialogs)</a></li>
            
              <li><a href="#">01</a></li>
            
              <li><a href="#">02</a></li>
            
              <li><a href="#">03</a></li>
            
              <li><a href="#">04</a></li>
            
              <li><a href="#">05</a></li>
            
              <li><a href="#">06</a></li>
            
          </ul>
        </div>
      </nav>
    </div>

    <div class="uk-container uk-container-expand">
      <ul class="uk-switcher switcher-container">
        
          <li> <h1>Action Bar &amp; Dialogs</h1>
<p>In a significant update to the app, we introduce navigation within the app using an Action Bar. This will allow us to create new residences, or navigate to existing ones. Additionally, we will explore a simple date picker dialog to allow the user to select a registration date for the residence.</p>
</li>
        
          <li> <h1>Overview</h1>
<p>At the end of this session the following features will have been added:</p>
<ul>
<li>The action bar with menus as shown in Figure 1
<img src="img/13.png" alt="Figure 1: Action bar and menu"></li>
</ul>
<ul>
<li>Date picker as shown in Figure 2
<img src="img/01.png" alt="Figure 2: Date picker to facilitate setting registration date"></li>
</ul>
</li>
        
          <li> <h1>Resources</h1>
<p>Continue building the MyRent app that you commenced in the previous lab.</p>
<p>We perform some surgery as follows on the incoming code base to allow the menus we are about to introduce to render correctly. </p>
<ul>
<li>Replace <em>ResidenceListActivity extends Activity</em>, changing the base class to AppCompatActivity.</li>
</ul>
<p>Moving on to ResidenceActivity, ensure the class header is as follows:</p>
<pre><code>public class ResidenceActivity extends AppCompatActivity implements TextWatcher, CompoundButton.OnCheckedChangeListener</code></pre>
<p>Remove the Activity import and replace with:</p>
<pre><code>import android.support.v7.app.AppCompatActivity;</code></pre>
<p>This change is required for backward compatibility  - otherwise the action bar menu item (+) will not be displayed.</p>
<p>For reference, the build.gradle (Module:app) file is presented here. Note the appcompat-v7 library dependency.</p>
<pre><code>apply plugin: &#39;com.android.application&#39;

android {
  compileSdkVersion 23
  buildToolsVersion &quot;23.0.3&quot;

  defaultConfig {
    applicationId &quot;org.wit.myrent&quot;
    minSdkVersion 19
    targetSdkVersion 23
    versionCode 1
    versionName &quot;1.0&quot;
  }
  buildTypes {
    release {
      minifyEnabled false
      proguardFiles getDefaultProguardFile(&#39;proguard-android.txt&#39;), &#39;proguard-rules.pro&#39;
    }
  }
}

dependencies {
  compile fileTree(dir: &#39;libs&#39;, include: [&#39;*.jar&#39;])
  testCompile &#39;junit:junit:4.12&#39;
  compile &#39;com.android.support:appcompat-v7:23.4.0&#39;
}</code></pre>
<p>We are now ready to proceed to introduce a new menu for display in ResidenceListActivity.</p>
<p><img src="img/17.png" alt="Figure 1: ResidenceListActivity menu"></p>
<ul>
<li>Add these string resources to <em>res/values/strings.xml</em></li>
</ul>
<pre><code>  &lt;string name=&quot;new_residence&quot;&gt;New Residence&lt;/string&gt;
  &lt;string name=&quot;settings&quot;&gt;Settings&lt;/string&gt;</code></pre>
<p>In the folder <em>res/menu</em> create a new file <em>residencelist.xml</em>.</p>
<p>Here is the file content:</p>
<p>Filename: residencelist.xml</p>
<pre><code>&lt;menu xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
      xmlns:tools=&quot;http://schemas.android.com/tools&quot;
      xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
      tools:context=&quot;org.wit.myrent.ResidenceActivity&quot;&gt;

  &lt;item android:id=&quot;@+id/menu_item_new_residence&quot;
        android:icon=&quot;@android:drawable/ic_menu_add&quot;
        android:title=&quot;@string/new_residence&quot;
        app:showAsAction=&quot;ifRoom|withText&quot;/&gt;


  &lt;item
      android:id=&quot;@+id/action_settings&quot;
      android:orderInCategory=&quot;100&quot;
      app:showAsAction=&quot;never&quot;
      android:title=&quot;@string/settings&quot;/&gt;

&lt;/menu&gt;</code></pre>
<p>Next, we bind this newly-created menu to the activity within which we wish the menu to appear, namely ResidenceListActivity.</p>
<ul>
<li>Add this override to ResidenceListActivity:</li>
</ul>
<pre><code>  @Override
  public boolean onCreateOptionsMenu(Menu menu)
  {
    MenuInflater menuInflater = getMenuInflater();
    menuInflater.inflate(R.menu.residencelist, menu);
    return true;
  }</code></pre>
<p>These imports are required:</p>
<pre><code>import android.view.Menu;
import android.view.MenuInflater;</code></pre>
<p>Observe in the above method, <em>onCreateOptionsMenu</em>, how the <em>residencelist</em> menu is accessed.</p>
<p>Figure 2 shows the relationship between the xml and display.</p>
<p><img src="img/14.png" alt="Figure 2: Action Bar &amp; Menu"></p>
<p>Build and run the application. You should see something like that shown in Figure 3.</p>
<p><img src="img/16.png" alt="Figure 3: Action Bar Menu"></p>
</li>
        
          <li> <h1>Helpers</h1>
<p>Add a new class named <em>IntentHelper</em> to <em>org.wit.android.helpers</em>.</p>
<p>Filename: IntentHelper.java</p>
<pre><code>package org.wit.android.helpers;
import java.io.Serializable;

import android.app.Activity;
import android.content.Intent;

public class IntentHelper
{
  public static void startActivity (Activity parent, Class classname)
  {
    Intent intent = new Intent(parent, classname);
    parent.startActivity(intent);
  }   

  public static void startActivityWithData (Activity parent, Class classname, String extraID, Serializable extraData)
  {
    Intent intent = new Intent(parent, classname);
    intent.putExtra(extraID, extraData);
    parent.startActivity(intent);
  }  

  public static void startActivityWithDataForResult (Activity parent, Class classname, String extraID, Serializable extraData, int idForResult)
  {
    Intent intent = new Intent(parent, classname);
    intent.putExtra(extraID, extraData);
    parent.startActivityForResult(intent, idForResult);
  }
}</code></pre>
</li>
        
          <li> <h1>Activities (ResidenceListActivity)</h1>
<p>Here we shall provide the coding to respond to menu selection:</p>
<p>Import the helpers provided in the previous step:</p>
<pre><code>import static org.wit.android.helpers.IntentHelper.startActivityWithData;
import static org.wit.android.helpers.IntentHelper.startActivityWithDataForResult;</code></pre>
<p>This import statement is necessary:</p>
<pre><code>import android.view.MenuItem;</code></pre>
<p>Now override <em>onOptionsItemSelected</em> to respond to selecting the menu item to create a new residence instance:</p>
<pre><code>  @Override
  public boolean onOptionsItemSelected(MenuItem item)
  {
    switch (item.getItemId())
    {
      case R.id.menu_item_new_residence: Residence residence = new Residence();
                                         portfolio.addResidence(residence);
                                         startActivityWithDataForResult(this, ResidenceActivity.class, &quot;RESIDENCE_ID&quot;, residence.id, 0);
                                         return true;    

      default: return super.onOptionsItemSelected(item);
    }
  }</code></pre>
<p>Add this line of code to <em>onItemClick</em></p>
<pre><code>startActivityWithData(this, ResidenceActivity.class, &quot;RESIDENCE_ID&quot;, residence.id);</code></pre>
<p>Delete remaining lines code: 
<img src="img/10.png" alt=""></p>
<p>Here is refactored method:</p>
<pre><code>  @Override
  public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position, long id)
  {
    Residence residence = adapter.getItem(position);
    startActivityWithData(this, ResidenceActivity.class, &quot;RESIDENCE_ID&quot;, residence.id);
  }</code></pre>
<p>We no longer use test data. Delete this line from Portfolio:
<img src="img/11.png" alt=""></p>
<p>Delete the now redundant method, also in Portfolio: <em>generateTestData</em></p>
<p><img src="img/12.png" alt=""></p>
<p>One small final change to org.wit.myrent.models.Residence:</p>
<ul>
<li>Add a default value for geoloction in the default constructor:</li>
</ul>
<pre><code>    geolocation = &quot;52.253456,-7.187162&quot;;</code></pre>
<p>This will ensure the the residence list will always display some meaningful data.</p>
<p>Here is the modified constructor:</p>
<pre><code>  public Residence()
  {
    id = unsignedLong();
    date = new Date().getTime();
    geolocation = &quot;52.253456,-7.187162&quot;;
  }</code></pre>
<p>Check that the app works as expected:</p>
<ul>
<li>Launch the app and select the menu item (+)</li>
<li>Optionally, make some changes to the residence data in the detail view</li>
<li>Switch back to the list view using the back-button.</li>
</ul>
<p>You should be presented with something similar to that shown in Figure 1.</p>
<p><img src="img/15.png" alt="Figure 1: Using menu to add new residence"></p>
</li>
        
          <li> <h1>Dialog</h1>
<p>The dialog in Figure 1 is an instance of <a href="http://developer.android.com/reference/android/app/DatePickerDialog.html"><strong>DatePickerDialog</strong></a> which is a simple dialog containing a <a href="http://developer.android.com/reference/android/widget/DatePicker.html"><strong>DatePicker</strong></a>.</p>
<ul>
<li>A DatePicker is a widget for selecting a date.</li>
</ul>
<p><img src="img/02.png" alt="Figure 1: DatePicker widget"></p>
<ul>
<li>As shown in Figure 2, the DatePicker is contained in <em>ResidenceActivity</em>.</li>
</ul>
<p><img src="img/03.png" alt="Figure 2: Object diagram showing DatePickerDialog"></p>
</li>
        
          <li> <h1>Activities (ResidenceActivity)</h1>
<p>We shall now implement the code to allow a user to set the registration date of a residence.</p>
<p>In <em>org.wit.myrent.activities.ResidenceActivity</em> add these import statements:</p>
<pre><code>import java.util.Calendar;
import java.util.Date;
import java.util.GregorianCalendar;

import android.app.DatePickerDialog;
import android.view.View;
import android.view.View.OnClickListener;</code></pre>
<p>Delete line disabling date button:
<img src="img/09.png" alt=""></p>
<p>Change the signature of ResidenceActivity class by adding </p>
<ul>
<li>View.OnClickListener</li>
<li>DatePickerDialog.OnDateSetListener</li>
</ul>
<p>to the list of implemented interfaces:</p>
<pre><code>public class ResidenceActivity extends Activity implements TextWatcher, OnCheckedChangeListener, View.OnClickListener, DatePickerDialog.OnDateSetListener
{
...
...
}</code></pre>
<p>This change will trigger errors. Add unimplemented methods manually or using the Android Studio hot keys to autogenerate the methods (as described in detail in previous labs such as in step 9 MyRent-00):</p>
<ul>
<li>public void onDateSet(DatePicker view, int year, int monthOfYear, int dayOfMonth)</li>
<li>public void onClick(View v)</li>
</ul>
<p>Here is the implementation of these methods:</p>
<pre><code>  @Override
  public void onClick(View view)
  {
    switch (view.getId())
    {
      case R.id.registration_date      : Calendar c = Calendar.getInstance();
                                         DatePickerDialog dpd = new DatePickerDialog (this, this, c.get(Calendar.YEAR), c.get(Calendar.MONTH), c.get(Calendar.DAY_OF_MONTH));
                                         dpd.show();
                                         break; 
    }
  }</code></pre>
<pre><code>  @Override
  public void onDateSet(DatePicker view, int year, int monthOfYear, int dayOfMonth)
  {
    Date date = new GregorianCalendar(year, monthOfYear, dayOfMonth).getTime();
    residence.date = date.getTime();
    dateButton.setText(residence.getDateString());
  }</code></pre>
<p>Set the date button listener in <em>onCreate</em>:</p>
<pre><code>dateButton  .setOnClickListener(this);</code></pre>
<p>Launch the app and test that this code works as intended:</p>
<ul>
<li>Create a new residence</li>
<li>Change the registration date</li>
<li>Return to the list view and create a further residence.</li>
<li>Return to the list view, click on the first residence, which opens its detail view, and observe that it retains the modified date.</li>
</ul>
<p><img src="img/18.png" alt="Figure 1: Date picker in action"></p>
<p>For reference, here is the completed ResidenceActivity class:</p>
<pre><code>package org.wit.myrent.activities;

import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.text.Editable;
import android.text.TextWatcher;
import android.util.Log;
import android.widget.Button;
import android.widget.CheckBox;
import android.widget.CompoundButton;
import android.widget.DatePicker;
import android.widget.EditText;

import org.wit.myrent.R;
import org.wit.myrent.app.MyRentApp;
import org.wit.myrent.models.Portfolio;
import org.wit.myrent.models.Residence;

import java.util.Calendar;
import java.util.Date;
import java.util.GregorianCalendar;
import android.app.DatePickerDialog;
import android.view.View;
import android.view.View.OnClickListener;


public class ResidenceActivity extends AppCompatActivity implements TextWatcher,
    CompoundButton.OnCheckedChangeListener,
    View.OnClickListener,
    DatePickerDialog.OnDateSetListener

{
  private EditText geolocation;
  private Residence residence;

  private CheckBox rented;
  private Button dateButton;

  private Portfolio portfolio;

  @Override
  protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_residence);

    geolocation = (EditText) findViewById(R.id.geolocation);
    residence = new Residence();

    // Register a TextWatcher in the EditText geolocation object
    geolocation.addTextChangedListener(this);

    dateButton = (Button) findViewById(R.id.registration_date);
    dateButton  .setOnClickListener(this);

    rented = (CheckBox) findViewById(R.id.isrented);

    MyRentApp app = (MyRentApp) getApplication();
    portfolio = app.portfolio;
    Long resId = (Long) getIntent().getExtras().getSerializable(&quot;RESIDENCE_ID&quot;);
    residence = portfolio.getResidence(resId);
    if (residence != null) {
      updateControls(residence);
    }
  }

  public void updateControls(Residence residence) {
    geolocation.setText(residence.geolocation);
    rented.setChecked(residence.rented);
    dateButton.setText(residence.getDateString());
  }

  @Override
  public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

  }

  @Override
  public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {

  }

  @Override
  public void afterTextChanged(Editable editable) {
    residence.setGeolocation(editable.toString());
  }

  @Override
  public void onCheckedChanged(CompoundButton compoundButton, boolean isChecked) {
    Log.i(this.getClass().getSimpleName(), &quot;rented Checked&quot;);
    residence.rented = isChecked;
  }

  @Override
  public void onClick(View view) {
    switch (view.getId())
    {
      case R.id.registration_date      : Calendar c = Calendar.getInstance();
        DatePickerDialog dpd = new DatePickerDialog (this, this, c.get(Calendar.YEAR), c.get(Calendar.MONTH), c.get(Calendar.DAY_OF_MONTH));
        dpd.show();
        break;
    }
  }

  @Override
  public void onDateSet(DatePicker view, int year, int monthOfYear, int dayOfMonth) {
    Date date = new GregorianCalendar(year, monthOfYear, dayOfMonth).getTime();
    residence.date = date.getTime();
    dateButton.setText(residence.getDateString());
  }
}</code></pre>
<p>The application at the end of this lab is available for reference here: <a href="https://github.com/wit-ictskills-2016/myrent-03.git">myrent-03</a></p>
</li>
        
      </ul>
    </div>

    <script>
      $(document).ready(function() {
  const $images = $('.lab img');
  jQuery.each($images, function(i) {
    if ($images[i].alt.length > 0) {
      const divImg = $(document.createElement('div')).addClass('');
      $($images[i]).wrap(divImg);
      const divLabel = $(document.createElement('div')).addClass('uk-label uk-text-lowercase');
      divLabel.append($images[i].alt);
      $(divLabel).insertAfter($images[i]);
      $('<br>').insertAfter($images[i]);
    }
  });
});

    </script>
  </body>
</html>